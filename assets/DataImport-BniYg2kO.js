import{t as S,j as a,a4 as x,r as n,a6 as y,ae as w,be as f,bf as b,aa as v,$ as C,ac as R}from"./index-B1Ja7tfw.js";import{l as j}from"./lzutf8-light-lXu8A2Ya.js";import{t as A}from"./index-DKi84PLp.js";import{u as M,c as F,d as m}from"./App-B0eBmnO2.js";const I=S(a.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),z=()=>{const{data:r}=M(),{t:i}=x(),{importAppState:u}=n.useContext(y),{importCollectionState:p}=n.useContext(w),d=F(),[c,g]=n.useState(r??""),h=n.useMemo(()=>A(t=>{try{return JSON.parse(j.decompress(decodeURIComponent(t).replace(/-/g,"/"),{inputEncoding:"Base64"}))}catch{return{}}},500),[]),e=n.useMemo(()=>{try{let t=h(r??c.split("/").pop()??"");if(!Array.isArray(t.savedStops)||!f(t.savedStops))throw new Error("Error in parsing savedStops");if(!Array.isArray(t.savedEtas)||!f(t.savedEtas))throw new Error("Error in parsing savedEtas");if(!Array.isArray(t.collections))throw new Error("Error in parsing collections");for(let o=0;o<t.collections.length;++o){if(typeof t.collections[o].name!="string")throw new Error("Error in parsing collections");for(let s=0;s<t.collections[o].list.length;++s)if(typeof t.collections[o].list[s]!="string")throw new Error("Error in parsing collections");for(let s=0;s<t.collections[o].schedules.length;++s){if(typeof t.collections[o].schedules[s].day!="number")throw new Error("Error in parsing collections");if(typeof t.collections[o].schedules[s].start.hour!="number")throw new Error("Error in parsing collections");if(typeof t.collections[o].schedules[s].start.minute!="number")throw new Error("Error in parsing collections");if(typeof t.collections[o].schedules[s].end.hour!="number")throw new Error("Error in parsing collections");if(typeof t.collections[o].schedules[s].end.minute!="number")throw new Error("Error in parsing collections")}}return t}catch(t){console.error(t)}return{}},[h,r,c]),l=n.useMemo(()=>JSON.stringify(e,null,2),[e]),E=n.useCallback(()=>{l!=="{}"&&(p({savedStops:e.savedStops??[],savedEtas:e.savedEtas??[],collections:e.collections??[],collectionDrawerRoute:null,collectionIdx:null}),u({geoPermission:null,compassPermission:"default",manualGeolocation:null,searchRoute:"",selectedRoute:"1-1-CHUK-YUEN-ESTATE-STAR-FERRY",routeSearchHistory:e.routeSearchHistory??[],isRouteFilter:e.isRouteFilter??!0,busSortOrder:e.busSortOrder??"KMB first",numPadOrder:e.numPadOrder??"123456789c0b",etaFormat:e.etaFormat??"diff",_colorMode:e._colorMode??"system",energyMode:e.energyMode??!1,platformMode:e.platformMode??!1,vibrateDuration:e.vibrateDuration??1,isVisible:!0,analytics:e.analytics??!0,refreshInterval:e.refreshInterval??30,annotateScheduled:e.annotateScheduled??!0,isRecentSearchShown:e.isRecentSearchShown??!0,fontSize:e.fontSize??16,searchRange:e.searchRange??b,isSearching:e.isSearching??!1}),d("/"))},[e,l,u,p,d]);return a.jsxs(v,{sx:T,children:[a.jsx(C,{variant:"h6",sx:{textAlign:"center"},children:i("資料匯入")}),!r&&a.jsx(m,{variant:"outlined",value:c,onChange:({target:{value:t}})=>g(t),fullWidth:!0,label:i("匯出網址")}),a.jsx(m,{multiline:!0,maxRows:15,value:l,disabled:!0,fullWidth:!0,spellCheck:!1}),a.jsx(R,{startIcon:a.jsx(I,{}),variant:"outlined",disabled:l==="{}",onClick:E,sx:k,children:i("Accept")})]})},T={display:"flex",flexDirection:"column",justifyContent:"flex-start",flex:1,gap:1},k={color:r=>r.palette.mode==="light"?r.palette.text.primary:r.palette.primary.main,borderColor:r=>r.palette.mode==="light"?r.palette.text.primary:r.palette.primary.main};export{z as default};
