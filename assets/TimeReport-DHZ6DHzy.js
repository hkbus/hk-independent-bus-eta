import{I as F,m as G,J as $,q as l,r as v,L as O,aZ as Te,p as V,Y as Ae,z as Ee,j as o,M as D,l as H,P as Se,a_ as te,f as S,a$ as re,b0 as Le,b1 as Me,F as pe,a4 as fe,a5 as me,a9 as ze,aa as P,$ as ge,a6 as Ne,am as ke,b2 as De}from"./index-B1Ja7tfw.js";import{q as Ie,s as he,t as se,P as Be,w as _e,x as We,y as qe,z as Ue,A as Fe}from"./App-B0eBmnO2.js";import{C as Ge}from"./CircularProgress-CrCOSSnb.js";function Oe(e){return G("MuiCollapse",e)}F("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Ve=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],He=e=>{const{orientation:t,classes:r}=e,n={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return H(n,Oe,r)},Xe=$("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.orientation],r.state==="entered"&&t.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&t.hidden]}})(({theme:e,ownerState:t})=>l({height:0,overflow:"hidden",transition:e.transitions.create("height")},t.orientation==="horizontal"&&{height:"auto",width:0,transition:e.transitions.create("width")},t.state==="entered"&&l({height:"auto",overflow:"visible"},t.orientation==="horizontal"&&{width:"auto"}),t.state==="exited"&&!t.in&&t.collapsedSize==="0px"&&{visibility:"hidden"})),Je=$("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})(({ownerState:e})=>l({display:"flex",width:"100%"},e.orientation==="horizontal"&&{width:"auto",height:"100%"})),Ke=$("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,t)=>t.wrapperInner})(({ownerState:e})=>l({width:"100%"},e.orientation==="horizontal"&&{width:"auto",height:"100%"})),xe=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiCollapse"}),{addEndListener:d,children:g,className:f,collapsedSize:c="0px",component:s,easing:h,in:u,onEnter:p,onEntered:m,onEntering:C,onExit:b,onExited:i,onExiting:x,orientation:y="vertical",style:j,timeout:w=Te.standard,TransitionComponent:B=Ie}=n,Y=V(n,Ve),M=l({},n,{orientation:y,collapsedSize:c}),T=He(M),_=he(),Z=Ae(),A=v.useRef(null),W=v.useRef(),z=typeof c=="number"?`${c}px`:c,L=y==="horizontal",q=L?"width":"height",X=v.useRef(null),ve=Ee(r,X),N=a=>R=>{if(a){const E=X.current;R===void 0?a(E):a(E,R)}},Q=()=>A.current?A.current[L?"clientWidth":"clientHeight"]:0,Ce=N((a,R)=>{A.current&&L&&(A.current.style.position="absolute"),a.style[q]=z,p&&p(a,R)}),ye=N((a,R)=>{const E=Q();A.current&&L&&(A.current.style.position="");const{duration:U,easing:J}=se({style:j,timeout:w,easing:h},{mode:"enter"});if(w==="auto"){const ne=_.transitions.getAutoHeightDuration(E);a.style.transitionDuration=`${ne}ms`,W.current=ne}else a.style.transitionDuration=typeof U=="string"?U:`${U}ms`;a.style[q]=`${E}px`,a.style.transitionTimingFunction=J,C&&C(a,R)}),Re=N((a,R)=>{a.style[q]="auto",m&&m(a,R)}),$e=N(a=>{a.style[q]=`${Q()}px`,b&&b(a)}),je=N(i),we=N(a=>{const R=Q(),{duration:E,easing:U}=se({style:j,timeout:w,easing:h},{mode:"exit"});if(w==="auto"){const J=_.transitions.getAutoHeightDuration(R);a.style.transitionDuration=`${J}ms`,W.current=J}else a.style.transitionDuration=typeof E=="string"?E:`${E}ms`;a.style[q]=z,a.style.transitionTimingFunction=U,x&&x(a)}),Pe=a=>{w==="auto"&&Z.start(W.current||0,a),d&&d(X.current,a)};return o.jsx(B,l({in:u,onEnter:Ce,onEntered:Re,onEntering:ye,onExit:$e,onExited:je,onExiting:we,addEndListener:Pe,nodeRef:X,timeout:w==="auto"?null:w},Y,{children:(a,R)=>o.jsx(Xe,l({as:s,className:D(T.root,f,{entered:T.entered,exited:!u&&z==="0px"&&T.hidden}[a]),style:l({[L?"minWidth":"minHeight"]:z},j),ref:ve},R,{ownerState:l({},M,{state:a}),children:o.jsx(Je,{ownerState:l({},M,{state:a}),className:T.wrapper,ref:A,children:o.jsx(Ke,{ownerState:l({},M,{state:a}),className:T.wrapperInner,children:g})})}))}))});xe.muiSupportAuto=!0;const be=v.createContext({});function Ye(e){return G("MuiAccordion",e)}const K=F("MuiAccordion",["root","rounded","expanded","disabled","gutters","region"]),Ze=["children","className","defaultExpanded","disabled","disableGutters","expanded","onChange","square","slots","slotProps","TransitionComponent","TransitionProps"],Qe=e=>{const{classes:t,square:r,expanded:n,disabled:d,disableGutters:g}=e;return H({root:["root",!r&&"rounded",n&&"expanded",d&&"disabled",!g&&"gutters"],region:["region"]},Ye,t)},et=$(Be,{name:"MuiAccordion",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${K.region}`]:t.region},t.root,!r.square&&t.rounded,!r.disableGutters&&t.gutters]}})(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{position:"relative",transition:e.transitions.create(["margin"],t),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(e.vars||e).palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${K.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${K.disabled}`]:{backgroundColor:(e.vars||e).palette.action.disabledBackground}}},({theme:e,ownerState:t})=>l({},!t.square&&{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(e.vars||e).shape.borderRadius,borderBottomRightRadius:(e.vars||e).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},!t.disableGutters&&{[`&.${K.expanded}`]:{margin:"16px 0"}})),Et=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiAccordion"}),{children:d,className:g,defaultExpanded:f=!1,disabled:c=!1,disableGutters:s=!1,expanded:h,onChange:u,square:p=!1,slots:m={},slotProps:C={},TransitionComponent:b,TransitionProps:i}=n,x=V(n,Ze),[y,j]=_e({controlled:h,default:f,name:"Accordion",state:"expanded"}),w=v.useCallback(L=>{j(!y),u&&u(L,!y)},[y,u,j]),[B,...Y]=v.Children.toArray(d),M=v.useMemo(()=>({expanded:y,disabled:c,disableGutters:s,toggle:w}),[y,c,s,w]),T=l({},n,{square:p,disabled:c,disableGutters:s,expanded:y}),_=Qe(T),Z=l({transition:b},m),A=l({transition:i},C),[W,z]=We("transition",{elementType:xe,externalForwardedProps:{slots:Z,slotProps:A},ownerState:T});return o.jsxs(et,l({className:D(_.root,g),ref:r,ownerState:T,square:p},x,{children:[o.jsx(be.Provider,{value:M,children:B}),o.jsx(W,l({in:y,timeout:"auto"},z,{children:o.jsx("div",{"aria-labelledby":B.props.id,id:B.props["aria-controls"],role:"region",className:_.region,children:Y})}))]}))});function tt(e){return G("MuiAccordionDetails",e)}F("MuiAccordionDetails",["root"]);const rt=["className"],ot=e=>{const{classes:t}=e;return H({root:["root"]},tt,t)},nt=$("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({padding:e.spacing(1,2,2)})),St=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiAccordionDetails"}),{className:d}=n,g=V(n,rt),f=n,c=ot(f);return o.jsx(nt,l({className:D(c.root,d),ref:r,ownerState:f},g))});function st(e){return G("MuiAccordionSummary",e)}const k=F("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),at=["children","className","expandIcon","focusVisibleClassName","onClick"],it=e=>{const{classes:t,expanded:r,disabled:n,disableGutters:d}=e;return H({root:["root",r&&"expanded",n&&"disabled",!d&&"gutters"],focusVisible:["focusVisible"],content:["content",r&&"expanded",!d&&"contentGutters"],expandIconWrapper:["expandIconWrapper",r&&"expanded"]},st,t)},lt=$(Se,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{const r={duration:e.transitions.duration.shortest};return l({display:"flex",minHeight:48,padding:e.spacing(0,2),transition:e.transitions.create(["min-height","background-color"],r),[`&.${k.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${k.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`&:hover:not(.${k.disabled})`]:{cursor:"pointer"}},!t.disableGutters&&{[`&.${k.expanded}`]:{minHeight:64}})}),ct=$("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(e,t)=>t.content})(({theme:e,ownerState:t})=>l({display:"flex",flexGrow:1,margin:"12px 0"},!t.disableGutters&&{transition:e.transitions.create(["margin"],{duration:e.transitions.duration.shortest}),[`&.${k.expanded}`]:{margin:"20px 0"}})),dt=$("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(e,t)=>t.expandIconWrapper})(({theme:e})=>({display:"flex",color:(e.vars||e).palette.action.active,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),[`&.${k.expanded}`]:{transform:"rotate(180deg)"}})),Lt=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiAccordionSummary"}),{children:d,className:g,expandIcon:f,focusVisibleClassName:c,onClick:s}=n,h=V(n,at),{disabled:u=!1,disableGutters:p,expanded:m,toggle:C}=v.useContext(be),b=y=>{C&&C(y),s&&s(y)},i=l({},n,{expanded:m,disabled:u,disableGutters:p}),x=it(i);return o.jsxs(lt,l({focusRipple:!1,disableRipple:!0,disabled:u,component:"div","aria-expanded":m,className:D(x.root,g),focusVisibleClassName:D(x.focusVisible,c),onClick:b,ref:r,ownerState:i},h,{children:[o.jsx(ct,{className:x.content,ownerState:i,children:d}),f&&o.jsx(dt,{className:x.expandIconWrapper,ownerState:i,children:f})]}))});function ut(e){return G("MuiLinearProgress",e)}F("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const pt=["className","color","value","valueBuffer","variant"];let I=e=>e,ae,ie,le,ce,de,ue;const ee=4,ft=te(ae||(ae=I`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),mt=te(ie||(ie=I`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),gt=te(le||(le=I`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),ht=e=>{const{classes:t,variant:r,color:n}=e,d={root:["root",`color${S(n)}`,r],dashed:["dashed",`dashedColor${S(n)}`],bar1:["bar",`barColor${S(n)}`,(r==="indeterminate"||r==="query")&&"bar1Indeterminate",r==="determinate"&&"bar1Determinate",r==="buffer"&&"bar1Buffer"],bar2:["bar",r!=="buffer"&&`barColor${S(n)}`,r==="buffer"&&`color${S(n)}`,(r==="indeterminate"||r==="query")&&"bar2Indeterminate",r==="buffer"&&"bar2Buffer"]};return H(d,ut,t)},oe=(e,t)=>t==="inherit"?"currentColor":e.vars?e.vars.palette.LinearProgress[`${t}Bg`]:e.palette.mode==="light"?Le(e.palette[t].main,.62):Me(e.palette[t].main,.5),xt=$("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`color${S(r.color)}`],t[r.variant]]}})(({ownerState:e,theme:t})=>l({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:oe(t,e.color)},e.color==="inherit"&&e.variant!=="buffer"&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},e.variant==="buffer"&&{backgroundColor:"transparent"},e.variant==="query"&&{transform:"rotate(180deg)"})),bt=$("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.dashed,t[`dashedColor${S(r.color)}`]]}})(({ownerState:e,theme:t})=>{const r=oe(t,e.color);return l({position:"absolute",marginTop:0,height:"100%",width:"100%"},e.color==="inherit"&&{opacity:.3},{backgroundImage:`radial-gradient(${r} 0%, ${r} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})},re(ce||(ce=I`
    animation: ${0} 3s infinite linear;
  `),gt)),vt=$("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t[`barColor${S(r.color)}`],(r.variant==="indeterminate"||r.variant==="query")&&t.bar1Indeterminate,r.variant==="determinate"&&t.bar1Determinate,r.variant==="buffer"&&t.bar1Buffer]}})(({ownerState:e,theme:t})=>l({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:e.color==="inherit"?"currentColor":(t.vars||t).palette[e.color].main},e.variant==="determinate"&&{transition:`transform .${ee}s linear`},e.variant==="buffer"&&{zIndex:1,transition:`transform .${ee}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&re(de||(de=I`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),ft)),Ct=$("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t[`barColor${S(r.color)}`],(r.variant==="indeterminate"||r.variant==="query")&&t.bar2Indeterminate,r.variant==="buffer"&&t.bar2Buffer]}})(({ownerState:e,theme:t})=>l({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},e.variant!=="buffer"&&{backgroundColor:e.color==="inherit"?"currentColor":(t.vars||t).palette[e.color].main},e.color==="inherit"&&{opacity:.3},e.variant==="buffer"&&{backgroundColor:oe(t,e.color),transition:`transform .${ee}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&re(ue||(ue=I`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),mt)),yt=v.forwardRef(function(t,r){const n=O({props:t,name:"MuiLinearProgress"}),{className:d,color:g="primary",value:f,valueBuffer:c,variant:s="indeterminate"}=n,h=V(n,pt),u=l({},n,{color:g,variant:s}),p=ht(u),m=he(),C={},b={bar1:{},bar2:{}};if((s==="determinate"||s==="buffer")&&f!==void 0){C["aria-valuenow"]=Math.round(f),C["aria-valuemin"]=0,C["aria-valuemax"]=100;let i=f-100;m.direction==="rtl"&&(i=-i),b.bar1.transform=`translateX(${i}%)`}if(s==="buffer"&&c!==void 0){let i=(c||0)-100;m.direction==="rtl"&&(i=-i),b.bar2.transform=`translateX(${i}%)`}return o.jsxs(xt,l({className:D(p.root,d),ownerState:u,role:"progressbar"},C,{ref:r},h,{children:[s==="buffer"?o.jsx(bt,{className:p.dashed,ownerState:u}):null,o.jsx(vt,{className:p.bar1,ownerState:u,style:b.bar1}),s==="determinate"?null:o.jsx(Ct,{className:p.bar2,ownerState:u,style:b.bar2})]}))}),Rt=pe.forwardRef(({sx:e,color:t,...r},n)=>o.jsx(yt,{color:t??"inherit",sx:{m:1,height:5,borderRadius:5,...e},ref:n,...r})),Mt=pe.forwardRef(({sx:e,color:t,...r},n)=>o.jsx(Ge,{color:t??"inherit",sx:{m:1,...e},ref:n,...r})),zt=({routeId:e,seq:t,containerSx:r,showStopName:n=!1})=>{const{t:d}=fe(),g=me(),{db:{routeList:f,stopList:c}}=v.useContext(ze),s=qe(`${e}/${t}`),{route:h,co:u,stops:p}=f[e],m=Object.values(p)[0][t],C=v.useMemo(()=>Object.values(f[e].stops).map(i=>c[i[i.length-1]].name).concat(f[e].dest),[f,e,c]),b=v.useMemo(()=>{let i=!1;return u[0]==="mtr"?i=p.mtr.indexOf(m)+1>=p.mtr.length:u.includes("lightRail")&&(i=p.lightRail.indexOf(m)+1>=p.lightRail.length),s===null?null:i&&s.length===0?d("終點站"):s.length>0&&s.every(x=>!x.eta)&&s[0].remark[g]?s[0].remark[g]:s.length===0||s.every(x=>!x.eta)?d("未有班次資料"):null},[s,u,p,m,d,g]);return s==null?o.jsx(P,{sx:r,children:o.jsx(Rt,{})}):o.jsxs(P,{sx:r,children:[n&&o.jsx(ge,{variant:"caption",children:c[m].name[g]}),b,s.length>0&&s.every(i=>i.eta)&&s.map((i,x)=>o.jsx($t,{eta:i,routeDests:C,showCompany:u.length>1,route:h},`route-${x}`))]})},$t=({eta:{eta:e,remark:t,co:r,dest:n},routeDests:d,showCompany:g,route:f})=>{const{t:c}=fe(),s=me(),{etaFormat:h,platformMode:u}=v.useContext(Ne),p=v.useMemo(()=>{if(r==="mtr")return!0;for(const j of d)if(j.en.toLowerCase()===n.en.toLowerCase()||j.zh===n.zh)return!1;return!0},[d,n,r]),m=Math.round((new Date(e).getTime()-new Date().getTime())/60/1e3),C=o.jsx(P,{component:"span",sx:h!=="exact"?{fontSize:"0.9em"}:{},children:e.slice(11,16)}),b=r==="mtr"||r==="lightRail";let i,x;b&&m<=1?(i=m===1?`${c("即將抵達")} `:`${c("正在離開")} `,x=!0):(i=m<1?" - ":`${m} `,x=!1);const y=o.jsxs(P,{component:"span",children:[o.jsx(P,{component:"span",sx:{...wt,color:j=>j.palette.warning.main},fontSize:x?"0.9em":void 0,children:i}),!x&&o.jsx(P,{component:"span",sx:{fontSize:"0.8em"},children:c("分鐘")})]});return o.jsxs(ge,{variant:"subtitle1",sx:{justifyContent:"center"},children:[h==="diff"&&y,h==="exact"&&C,h==="mixed"&&o.jsxs(o.Fragment,{children:[C," ",y]}),!b&&o.jsx(o.Fragment,{children:" - "}),o.jsxs(P,{component:"span",sx:{fontSize:"0.8em",textOverflow:"ellipsis"},children:[g&&o.jsxs(o.Fragment,{children:[" ",c(r)]})," ",o.jsx(jt,{remark:t,co:r,language:s,route:f,platformMode:u}),b&&" ",!b&&o.jsx(o.Fragment,{children:" "}),p&&n[s]]})]})},jt=({remark:e,language:t,co:r,route:n,platformMode:d})=>{if(e===null)return"";if(!(r==="mtr"||r==="lightRail"))return e[t];const f=[];let c="",s="";return(e.en||e[t]).split(" - ").forEach((h,u)=>{const p=[...h.matchAll(/^Platform (\d+)$/g)??[]][0]||[];if(p.length===2&&p[1].length){c=ke(Number(p[1]),d)??p[1];return}const m=(/^▭+$/g.exec(h)??[])[0];if(m){s=m;return}f.push(e[t].split(" - ")[u])}),o.jsxs(o.Fragment,{children:[o.jsx(P,{component:"span",color:De([r],n,!0),sx:{marginX:.25},children:c}),o.jsxs(P,{component:"span",sx:{marginX:.25},children:[s.length===1&&o.jsx(Ue,{}),s.length===2&&o.jsx(Fe,{})]}),f.map((h,u)=>o.jsx(P,{component:"span",sx:{marginX:.25},children:h},u))]})},wt={fontWeight:"700",color:"#088bce"};export{Et as A,Mt as C,Rt as L,zt as T,Lt as a,St as b};
